# ゲームバランス設定書 (`game_balance.xlsx`) ガイド

このExcelファイルはゲームの各種パラメータを管理するためのマスターデータです。
変更後は `tools/update_settings.py` を実行することでゲームに反映されます。

## シート一覧

### 1. Physics (物理挙動)
ゲーム全体の物理演算に関する定数設定です。

| Parameter | 説明 | 初期値 |
| :--- | :--- | :--- |
| **BASE_ACCEL** | プレイヤーの基本加速度 | 0.03 |
| **BASE_MAX_SPEED** | プレイヤーの基本最大速度 | 6.0 |
| **BRAKE_FORCE** | ブレーキ力 | 0.15 |
| **FRICTION** | 減速摩擦係数（慣性） | 0.99 |
| **CARGO_HP_BASE** | 貨物の基本HP | 100 |
| **MISSION_SCALE** | 距離の進み具合（値が大きいほど早く進む） | 120 |
| **MISSILE_DAMAGE** | 敵ミサイルの基本ダメージ | 40 |
| **MISSILE_COOLDOWN** | 敵ミサイルの発射間隔（フレーム） | 60 |

### 2. Player (プレイヤー基本能力)
プレイヤーの基本ステータス値です（アップグレード前の初期値）。

| Parameter | 説明 |
| :--- | :--- |
| **HP** | 初期耐久値 |
| **ENGINE** | エンジン出力（積載量に影響） |
| **ACCEL** | 加速性能 |
| **SPEED** | 最高速度 |
| **BRAKE** | 停止性能 |
| **WEAPON_OS** | 武器制御（攻撃力補正） |
| **GRID_W** | 初期グリッド幅 |
| **GRID_H** | 初期グリッド高さ |

### 3. Weapons (武器データ)
プレイヤーが装備可能な武器の定義です。

| カラム名 | 説明 |
| :--- | :--- |
| **ID** | システム上のID（重複不可） |
| **Name** | ゲーム内表示名 |
| **Type** | `Main` (自動発射) または `Sub` (ミサイル枠) |
| **Damage** | 単発威力 |
| **Speed** | 弾速 (レーザー等は999) |
| **Interval** | 発射間隔（フレーム数、60=1秒） |
| **W / H** | グリッド上のサイズ (幅/高さ) |
| **Weight** | 重量（速度に悪影響） |
| **Homing** | 誘導性能（0=なし, 値が大きいほど強い） |
| **Count** | 一度の発射数 |
| **Range** | 爆風範囲や射程など |
| **UpgradeCost** | ショップでの強化コスト係数 |

### 4. Enemies (敵データ)
出現する敵のステータス定義です。

| カラム名 | 説明 |
| :--- | :--- |
| **ID** | 敵ID |
| **HP** | 耐久力 |
| **Speed** | 落下速度 |
| **DropRate** | アイテムドロップ率 (0.0 - 1.0) |

### 5. Parts (装備パーツ)
武器以外の装備品（強化パーツ）の定義です。

| カラム名 | 説明 |
| :--- | :--- |
| **ID** | パーツID |
| **Type** | `Option` (汎用パーツ) |
| **W / H** | サイズ |
| **Price** | 購入価格 |
| **Desc** | 説明文 |

### 6. UpgradeTable (アップグレード定義)
ステータス強化ごとの上昇値とコストの詳細定義です。

| カラム名 | 説明 |
| :--- | :--- |
| **StatType** | 対象ステータス (HP, ENGINE, etc.) |
| **Level** | レベル (0-100) |
| **ValuePlus** | そのレベルでの加算値 |
| **Cost** | 次のレベルへの強化費用 |
| **MaterialID** | 必要素材ID (未実装/将来用) |
| **MaterialCount** | 必要素材数 |

### 7. Weather (天候定義)
天候の種類と効果です。

| カラム名 | 説明 |
| :--- | :--- |
| **Key** | 天候キー (CLEAR, RAIN, SQUALL, HELL) |
| **Name** | 表示名 |
| **WindX/Y** | 風の影響 |
| **Rain** | 雨の強さ (視界や弾速への影響) |

### 8. Stages (ステージ進行 - レガシー)
（旧仕様）ステージごとの基本設定。現在は主に敵の強さ倍率などに使用。

---

## 依頼 & 天候システム (New!)

### 9. MissionScaling (難易度抽選)
プレイヤーの「能力値合計」に応じた、依頼難易度（★）の出現確率テーブルです。

| カラム名 | 説明 |
| :--- | :--- |
| **MinStat** | この行が適用される最小合計能力値 |
| **Prob1** | ★1 が選ばれる確率 (%) |
| **Prob2** | ★2 が選ばれる確率 (%) |
| **Prob3 - Prob5** | ★3 - ★5 の確率 |

**例:** `MinStat: 10` の行は、能力値合計が10以上30未満の時に適用され、Prob1(50%)、Prob2(40%)… の確率で依頼が生成されます。

### 10. MissionParams (難易度別パラメータ)
各難易度（★）ごとの依頼内容の設定です。

| カラム名 | 説明 |
| :--- | :--- |
| **Stars** | 難易度 (1-5) |
| **DistMin/Max** | 距離の最小/最大値 (km) |
| **RewardMod** | 報酬の倍率係数 |
| **WeatherTable** | 使用する天候確率テーブルID (EASY, NORMAL, HARD) |
| **EnemyTier** | 出現する敵の強さランク (Tier1, Tier2...) |

### 11. WeatherTables (天候確率)
`MissionParams` で指定される天候テーブルの中身です。

| カラム名 | 説明 |
| :--- | :--- |
| **TableID** | テーブルID (EASY, NORMAL, etc.) |
| **Clear** | 快晴になる確率 (%) |
| **Rain** | 雨になる確率 (%) （旧Cloudy） |
| **Squall** | スコールになる確率 (%) （旧Rain） |
| **Hell** | 地獄になる確率 (%) （New!） |

ゲーム中、**距離600進むごとに** このテーブルに基づいて天候の再抽選が行われます。
